{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://novel-dev.org/schemas/style-profile.schema.json",
  "title": "StyleProfile",
  "description": "Reference style profile for stylometric analysis and style-guided generation",
  "type": "object",
  "required": ["id", "name", "sourceDescription", "createdAt", "stylometrics", "qualitativePatterns", "constraints"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for the profile"
    },
    "name": {
      "type": "string",
      "description": "Profile name (e.g., 'Author X Style' or 'Reference Novel Y')"
    },
    "sourceDescription": {
      "type": "string",
      "description": "Description of what the profile was extracted from"
    },
    "createdAt": {
      "type": "string",
      "description": "ISO 8601 timestamp of creation",
      "format": "date-time"
    },
    "stylometrics": {
      "type": "object",
      "description": "Quantitative stylometric patterns",
      "required": ["lexicalDiversity", "sentenceStatistics", "dialogueMetrics", "sensoryMetrics", "rhythmPatterns"],
      "properties": {
        "lexicalDiversity": {
          "type": "object",
          "description": "Vocabulary richness metrics",
          "required": ["ttr", "mtld", "uniqueWordCount", "totalWordCount"],
          "properties": {
            "ttr": {
              "type": "number",
              "description": "Type-Token Ratio (0-1)",
              "minimum": 0,
              "maximum": 1
            },
            "mtld": {
              "type": "number",
              "description": "Measure of Textual Lexical Diversity (typically 50-150)",
              "minimum": 0
            },
            "uniqueWordCount": {
              "type": "integer",
              "description": "Number of unique words",
              "minimum": 0
            },
            "totalWordCount": {
              "type": "integer",
              "description": "Total number of words",
              "minimum": 0
            }
          },
          "additionalProperties": false
        },
        "sentenceStatistics": {
          "type": "object",
          "description": "Sentence length patterns",
          "required": ["meanLength", "stdDeviation", "distribution"],
          "properties": {
            "meanLength": {
              "type": "number",
              "description": "Average words per sentence",
              "minimum": 0
            },
            "stdDeviation": {
              "type": "number",
              "description": "Standard deviation of sentence lengths",
              "minimum": 0
            },
            "distribution": {
              "type": "object",
              "description": "Sentence length distribution buckets",
              "required": ["short", "medium", "long", "veryLong"],
              "properties": {
                "short": {
                  "type": "number",
                  "description": "< 10 words (percentage 0-1)",
                  "minimum": 0,
                  "maximum": 1
                },
                "medium": {
                  "type": "number",
                  "description": "10-20 words (percentage 0-1)",
                  "minimum": 0,
                  "maximum": 1
                },
                "long": {
                  "type": "number",
                  "description": "20-35 words (percentage 0-1)",
                  "minimum": 0,
                  "maximum": 1
                },
                "veryLong": {
                  "type": "number",
                  "description": "> 35 words (percentage 0-1)",
                  "minimum": 0,
                  "maximum": 1
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "dialogueMetrics": {
          "type": "object",
          "description": "Dialogue usage patterns",
          "required": ["dialogueRatio", "avgDialogueLength", "dialogueToNarrationTransitions"],
          "properties": {
            "dialogueRatio": {
              "type": "number",
              "description": "Dialogue / total content ratio (0-1)",
              "minimum": 0,
              "maximum": 1
            },
            "avgDialogueLength": {
              "type": "number",
              "description": "Average words per dialogue line",
              "minimum": 0
            },
            "dialogueToNarrationTransitions": {
              "type": "number",
              "description": "Dialogue-to-narration transitions per 1000 chars",
              "minimum": 0
            }
          },
          "additionalProperties": false
        },
        "sensoryMetrics": {
          "type": "object",
          "description": "Sensory word usage",
          "required": ["sensoryDensity", "dominantSenses"],
          "properties": {
            "sensoryDensity": {
              "type": "number",
              "description": "Sensory words per 1000 chars",
              "minimum": 0
            },
            "dominantSenses": {
              "type": "array",
              "description": "Dominant senses in order of frequency",
              "items": {
                "type": "string",
                "enum": ["visual", "auditory", "tactile", "olfactory", "gustatory"]
              },
              "uniqueItems": true
            }
          },
          "additionalProperties": false
        },
        "rhythmPatterns": {
          "type": "object",
          "description": "Rhythm and structure patterns",
          "required": ["paragraphLengthMean", "paragraphLengthStdDev", "sentenceVariation"],
          "properties": {
            "paragraphLengthMean": {
              "type": "number",
              "description": "Average paragraph length in words",
              "minimum": 0
            },
            "paragraphLengthStdDev": {
              "type": "number",
              "description": "Standard deviation of paragraph lengths",
              "minimum": 0
            },
            "sentenceVariation": {
              "type": "number",
              "description": "Coefficient of variation for sentence lengths (stdDev / mean)",
              "minimum": 0
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "qualitativePatterns": {
      "type": "object",
      "description": "Qualitative style patterns",
      "required": ["toneDescriptors", "narrativeVoice", "paceDescriptor", "dialogueStyle"],
      "properties": {
        "toneDescriptors": {
          "type": "array",
          "description": "Tone descriptors (e.g., 'melancholic', 'sparse', 'lyrical')",
          "items": {
            "type": "string"
          }
        },
        "narrativeVoice": {
          "type": "string",
          "description": "Narrative point of view",
          "enum": ["first-person", "third-person-limited", "third-person-omniscient"]
        },
        "paceDescriptor": {
          "type": "string",
          "description": "Overall pacing",
          "enum": ["slow", "moderate", "fast", "variable"]
        },
        "dialogueStyle": {
          "type": "string",
          "description": "Dialogue usage style",
          "enum": ["minimal", "balanced", "dialogue-heavy"]
        }
      },
      "additionalProperties": false
    },
    "constraints": {
      "type": "array",
      "description": "Generated constraints for prompts",
      "items": {
        "type": "object",
        "required": ["aspect", "target", "tolerance"],
        "properties": {
          "aspect": {
            "type": "string",
            "description": "Style aspect this constraint targets",
            "enum": ["sentence-length", "vocabulary", "dialogue", "sensory", "rhythm"]
          },
          "target": {
            "type": "string",
            "description": "Human-readable target description"
          },
          "tolerance": {
            "type": "number",
            "description": "Acceptable deviation (0-1, e.g., 0.2 = 20% tolerance)",
            "minimum": 0,
            "maximum": 1
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
